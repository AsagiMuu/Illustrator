<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸³ç¥¨ç”Ÿæˆãƒ„ãƒ¼ãƒ« - Asagimuu</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for Theme */
        :root {
            --primary-color: #00A3AF;
            --accent-color: #72C7C3;
            --bg-color: #F0FAFA;
            --text-color: #384D48;
            --border-radius: 8px;
        }

        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: #f5f5f5;
            color: var(--text-color);
        }

        /* Layout */
        .container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: #2c3e50;
            color: white;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar h2 {
            font-size: 18px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #34495e;
        }

        .sidebar-section {
            margin-bottom: 30px;
        }

        .sidebar-section h3 {
            font-size: 14px;
            color: #95a5a6;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .template-btn,
        .color-btn,
        .download-btn {
            width: 100%;
            padding: 12px;
            margin-bottom: 8px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            text-align: left;
        }

        .template-btn {
            background: #34495e;
            color: white;
        }

        .template-btn:hover {
            background: #415a77;
        }

        .template-btn.active {
            background: var(--primary-color);
            font-weight: bold;
        }

        .color-btn {
            background: white;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .color-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .color-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
        }

        .download-btn {
            background: #27ae60;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .download-btn:hover {
            background: #229954;
        }

        /* Preview Area */
        .preview {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .a4-page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 10mm;
            margin-bottom: 20px;
        }

        /* Editable Fields */
        [contenteditable="true"] {
            outline: 2px dashed transparent;
            transition: outline 0.2s;
            border-radius: 2px;
            padding: 2px;
        }

        [contenteditable="true"]:hover {
            outline-color: var(--primary-color);
            background: #f0fffe;
        }

        [contenteditable="true"]:focus {
            outline-color: var(--primary-color);
            background: #fff;
        }

        /* Print Styles */
        @media print {
            @page {
                margin: 0;
                size: A4;
            }

            * {
                overflow: visible !important;
            }

            body {
                background: white;
                margin: 0;
                padding: 0;
            }

            .sidebar {
                display: none !important;
            }

            .preview {
                padding: 0;
                margin: 0;
                overflow: visible !important;
            }

            .a4-page {
                width: 210mm;
                height: 296mm;
                /* å¾®èª¿æ•´ */
                margin: 0;
                padding: 8mm;
                /* ã•ã‚‰ã«ç¸®å° */
                box-shadow: none;
                overflow: hidden !important;
                /* ã¯ã¿å‡ºã—é˜²æ­¢ */
            }

            .no-print {
                display: none !important;
            }
        }

        /* Template Common Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 10px;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 5px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-placeholder {
            width: 40px;
            height: 40px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
        }

        .title-area h1 {
            font-size: 26px;
            margin: 0;
            color: var(--primary-color);
            letter-spacing: 2px;
        }

        .title-area span {
            font-size: 12px;
            color: var(--accent-color);
            font-weight: bold;
            display: block;
            margin-top: 2px;
        }

        .doc-meta {
            text-align: right;
            font-size: 11px;
            line-height: 1.4;
            color: #666;
        }

        /* Address Area */
        .address-area {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .client-info {
            width: 55%;
            padding-top: 10px;
        }

        .client-name {
            font-size: 20px;
            font-weight: bold;
            border-bottom: 1px dashed var(--primary-color);
            padding-bottom: 2px;
            margin-bottom: 4px;
            display: inline-block;
            min-width: 200px;
        }

        .sender-info {
            width: 38%;
            font-size: 11px;
            line-height: 1.6;
            background-color: var(--bg-color);
            padding: 10px;
            border-radius: var(--border-radius);
            border: 1px solid #D0EBEB;
        }

        .sender-job-title {
            font-size: 10px;
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 2px;
        }

        .sender-name {
            font-size: 14px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        /* Table Styles */
        .table-wrap {
            margin-bottom: 10px;
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid var(--primary-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        th,
        td {
            padding: 6px 10px;
            vertical-align: middle;
            border-bottom: 1px solid #eee;
        }

        th {
            border-right: 1px solid #fff;
            background-color: var(--bg-color);
            color: var(--primary-color);
            font-weight: bold;
            text-align: left;
        }

        td {
            border-left: 1px solid #eee;
        }

        /* Total Area */
        .total-area {
            margin-top: 10px;
            text-align: right;
            padding: 10px 15px;
            background-color: var(--bg-color);
            border-radius: var(--border-radius);
            color: var(--primary-color);
            border: 1px solid #D0EBEB;
        }

        .total-label {
            font-size: 14px;
            margin-right: 30px;
            font-weight: bold;
        }

        .total-amount {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        /* Bank Info */
        .bank-info {
            margin-top: 10px;
            padding: 15px;
            background-color: #fafafa;
            border-radius: var(--border-radius);
            border: 1px dashed #ccc;
            font-size: 13px;
        }

        .bank-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 13px;
            color: var(--text-color);
        }

        /* Notes Area */
        .notes-area {
            margin-top: 10px;
            border: none;
            border-radius: var(--border-radius);
            padding: 10px;
            min-height: 60px;
            font-size: 12px;
            line-height: 1.6;
        }

        .notes-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 13px;
            color: var(--primary-color);
            border-left: 4px solid var(--primary-color);
            padding-left: 8px;
        }

        /* Summary Grid for Confirmation */
        .info-table th {
            width: 22%;
        }

        .info-table td {
            width: 28%;
        }

        /* Card Layout for Details */
        .section-header {
            font-size: 15px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .section-add-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 6px 16px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .section-add-btn:hover {
            background: var(--accent-color);
        }

        .detail-card {
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            background: #fff;
            padding: 15px 20px;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .card-number {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 13px;
        }

        .card-delete-btn {
            background: transparent;
            border: 1px solid #ddd;
            color: #999;
            padding: 3px 10px;
            border-radius: 3px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .card-delete-btn:hover {
            background: #f44336;
            border-color: #f44336;
            color: white;
        }

        .card-body {
            font-size: 13px;
            line-height: 1.8;
        }

        .spec-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px 15px;
            margin-bottom: 12px;
        }

        .spec-item {
            display: flex;
            gap: 8px;
        }

        .spec-item label {
            font-size: 12px;
            color: #666;
            font-weight: 600;
            min-width: 60px;
        }

        .spec-value {
            font-size: 12px;
            color: #333;
            flex: 1;
        }

        .description {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #f0f0f0;
        }

        .description label {
            display: block;
            font-size: 11px;
            color: #666;
            font-weight: bold;
            margin-bottom: 6px;
        }

        .description-content {
            font-size: 12px;
            line-height: 1.6;
            color: #333;
            padding: 8px;
            background: #fafafa;
            border-radius: 3px;
        }

        /* Two-Column Layout for Details */
        .notes-flex {
            display: flex;
            gap: 20px;
        }

        .notes-left {
            width: 25%;
            border-right: 1px dashed #ddd;
            padding-right: 15px;
        }

        .notes-right {
            width: 75%;
        }

        .sub-label {
            font-weight: bold;
            font-size: 12px;
            color: var(--text-color);
            margin-top: 5px;
            margin-bottom: 3px;
            display: block;
            border-bottom: 1px dashed #ddd;
            padding-bottom: 2px;
        }

        .sub-label:first-child {
            margin-top: 0;
        }

        .sub-content {
            padding-left: 5px;
            color: #444;
            margin-bottom: 8px;
            word-wrap: break-word;
            font-size: 12px;
            line-height: 1.6;
        }

        /* Detail Section Header with Buttons */
        .detail-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--primary-color);
        }

        .detail-section-title {
            font-weight: bold;
            font-size: 14px;
            color: var(--primary-color);
        }

        .detail-buttons {
            display: flex;
            gap: 8px;
        }

        .add-detail-btn,
        .delete-detail-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-detail-btn:hover {
            background: var(--accent-color);
        }

        .delete-detail-btn {
            background: #e74c3c;
        }

        .delete-detail-btn:hover {
            background: #c0392b;
        }

        .detail-card-number {
            font-weight: bold;
            font-size: 14px;
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 10px;
            padding-bottom: 2px;
            display: inline-block;
        }

        /* Invoice Row Buttons */
        .invoice-row-controls {
            text-align: center;
            padding: 5px;
        }

        .add-row-btn,
        .delete-row-btn {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 3px;
        }

        .add-row-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .delete-row-btn {
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .delete-row-btn:hover {
            background: #e74c3c;
            color: white;
        }

        /* Detail Card Wrapper */
        .detail-card-wrapper {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            background: #fafafa;
        }

        .detail-card-number {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 13px;
        }

        /* ============================================
           Print Styles - PDFå‡ºåŠ›ç”¨ã®æœ€é©åŒ–
           ============================================ */
        @media print {

            /* èƒŒæ™¯è‰²ã¨å¢ƒç•Œç·šã‚’å¼·åˆ¶çš„ã«å°åˆ· */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* ãƒšãƒ¼ã‚¸è¨­å®š */
            @page {
                margin: 15mm;
                size: A4;
            }

            body {
                margin: 0;
                padding: 0;
            }

            /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¨ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º */
            .sidebar,
            .no-print,
            .template-btn,
            .color-btn,
            .print-btn {
                display: none !important;
            }

            /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å…¨å¹…ã« */
            .container {
                display: block;
            }

            .main-content {
                max-width: 100%;
                padding: 0;
                box-shadow: none;
            }

            /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç”»é¢è¡¨ç¤ºã¨å®Œå…¨ä¸€è‡´ */
            /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç”»é¢è¡¨ç¤ºã¨å®Œå…¨ä¸€è‡´ */
            .table-wrap {
                border: none !important;
                /* å¤–æ ã‚’box-shadowã§æç”»ã—ã¦æœ€å‰é¢ã«è¦‹ã›ã‚‹ */
                box-shadow: 0 0 0 1px var(--primary-color) !important;
                border-radius: 8px !important;
                overflow: hidden;
                position: relative;
                z-index: 2;
            }

            table {
                border-collapse: collapse !important;
                width: 100% !important;
            }

            /* ç¢ºèªæ›¸ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯è§’ä¸¸ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã« separate ã«ã™ã‚‹ */
            table.info-table {
                border-collapse: separate !important;
                border-spacing: 0;
                border: none !important;
            }

            /* info-table ã®ã‚»ãƒ«å¢ƒç•Œç·šã®èª¿æ•´ã¨èƒŒæ™¯è‰²ã®è§’ä¸¸åŒ– */
            .info-table th,
            .info-table td {
                border-bottom: 1px solid #eee !important;
                border-right: 1px solid #eee !important;
            }

            /* å·¦ä¸Šã®ã‚»ãƒ« */
            .info-table tr:first-child th:first-child {
                border-top-left-radius: 8px !important;
            }

            /* å³ä¸Šã®ã‚»ãƒ« */
            .info-table tr:first-child td:last-child {
                border-top-right-radius: 8px !important;
            }

            /* å·¦ä¸‹ã®ã‚»ãƒ« */
            .info-table tr:last-child th:first-child {
                border-bottom-left-radius: 8px !important;
            }

            /* å³ä¸‹ã®ã‚»ãƒ« */
            .info-table tr:last-child td:last-child {
                border-bottom-right-radius: 8px !important;
            }

            .info-table tr:last-child th,
            .info-table tr:last-child td {
                border-bottom: none !important;
            }

            .info-table tr th:last-child,
            .info-table tr td:last-child {
                border-right: none !important;
            }

            th,
            td {
                padding: 10px 15px !important;
                border-bottom: 1px solid #eee !important;
            }

            th {
                border-right: 1px solid #fff !important;
                background-color: var(--bg-color) !important;
                color: var(--primary-color) !important;
                font-weight: bold !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            td {
                border-left: 1px solid #eee !important;
                background-color: white !important;
            }

            /* å°è¨ˆãƒ»æ¶ˆè²»ç¨è¡Œã®èƒŒæ™¯è‰²ï¼ˆè«‹æ±‚æ›¸ç”¨ï¼‰ - info-tableä»¥å¤–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«é©ç”¨ */
            /* é‡‘é¡ã‚»ãƒ«ã¨é …ç›®åã‚»ãƒ«ã®ã¿èƒŒæ™¯è‰²ã‚’ã¤ã‘ã‚‹ */
            table:not(.info-table) tbody tr:last-child td:last-child,
            table:not(.info-table) tbody tr:last-child td:nth-last-child(2),
            table:not(.info-table) tbody tr:nth-last-child(2) td:last-child,
            table:not(.info-table) tbody tr:nth-last-child(2) td:nth-last-child(2) {
                background-color: var(--bg-color) !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* å°è¨ˆãƒ»æ¶ˆè²»ç¨è¡Œã®å·¦å´ã®ç©ºã‚»ãƒ«ã¯èƒŒæ™¯è‰²ãªã— */
            table:not(.info-table) tbody tr:last-child td:first-child,
            table:not(.info-table) tbody tr:nth-last-child(2) td:first-child {
                background-color: transparent !important;
                border: none !important;
            }

            /* ç¢ºèªæ›¸ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚»ãƒ«ã¯ç™½èƒŒæ™¯ */
            .info-table td {
                background-color: white !important;
            }

            /* é€ä¿¡è€…ã‚«ãƒ¼ãƒ‰ã®èƒŒæ™¯è‰²ã‚’ç”»é¢è¡¨ç¤ºã¨åŒã˜ã« */
            .sender-info {
                background-color: var(--bg-color) !important;
                border: 1px solid #D0EBEB !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .client-info {
                background-color: transparent !important;
            }

            /* åˆè¨ˆé‡‘é¡ã‚¨ãƒªã‚¢ã®èƒŒæ™¯è‰²ã‚’ç”»é¢è¡¨ç¤ºã¨åŒã˜ã« */
            .total-area {
                background-color: var(--bg-color) !important;
                border: 1px solid #D0EBEB !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* éŠ€è¡Œæƒ…å ±ã®èƒŒæ™¯è‰²ã‚’ç”»é¢è¡¨ç¤ºã¨åŒã˜ã« */
            .bank-info {
                background-color: #fafafa !important;
                border: 1px dashed #ccc !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .notes-area {
                background-color: transparent !important;
                border: none !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* è«‹æ±‚æ›¸ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ã®è§’ä¸¸åŒ– */
            table:not(.info-table) thead tr:first-child th:first-child {
                border-top-left-radius: 8px !important;
                border-left: none !important;
                /* box-shadowã«ä»»ã›ã‚‹ */
            }

            table:not(.info-table) thead tr:first-child th:last-child {
                border-top-right-radius: 8px !important;
                border-right: none !important;
                /* box-shadowã«ä»»ã›ã‚‹ */
            }

            /* è«‹æ±‚æ›¸ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆæœ€ä¸‹éƒ¨ï¼‰ã®è§’ä¸¸åŒ– */
            table:not(.info-table) tbody tr:last-child td:first-child {
                border-bottom-left-radius: 8px !important;
                border-left: none !important;
            }

            table:not(.info-table) tbody tr:last-child td:last-child {
                border-bottom-right-radius: 8px !important;
                border-right: none !important;
            }

            /* è«‹æ±‚æ›¸ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã®æ ç·šèª¿æ•´ */
            table:not(.info-table) {
                border-collapse: separate !important;
                border-spacing: 0;
                /* å¤–æ ã‚’box-shadowã§æç”»ã—ã¦æœ€å‰é¢ã«è¦‹ã›ã‚‹ */
                box-shadow: 0 0 0 1px #00A3AF !important;
                border-radius: 8px !important;
                overflow: hidden !important;
                border: none !important;
            }

            table:not(.info-table) th,
            table:not(.info-table) td {
                border-bottom: 1px solid #eee !important;
                border-right: 1px solid #eee !important;
                position: relative;
                /* z-indexã‚’åŠ¹ã‹ã›ã‚‹ãŸã‚ */
                z-index: 1;
            }

            table:not(.info-table) tr td:first-child,
            table:not(.info-table) tr th:first-child {
                border-left: none !important;
            }

            /* å¤–æ ã®è‰²ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ï¼‰ */
            table:not(.info-table) thead tr th {
                border-top: none !important;
                border-bottom: 1px solid #00A3AF !important;
            }

            /* å³ç«¯ã®ç·šã¯box-shadowã«ä»»ã›ã‚‹ãŸã‚å‰Šé™¤ */
            table:not(.info-table) tr th:last-child,
            table:not(.info-table) tr td:last-child {
                border-right: none !important;
            }

            /* contenteditableè¦ç´ ã®ç·¨é›†ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å‰Šé™¤ */
            [contenteditable="true"] {
                border: none !important;
                outline: none !important;
            }

            /* æ”¹ãƒšãƒ¼ã‚¸åˆ¶å¾¡ */
            .header,
            .address-area,
            .total-area,
            .table-wrap,
            .bank-info {
                page-break-inside: avoid;
            }

            /* è©³ç´°ã‚«ãƒ¼ãƒ‰ã®èƒŒæ™¯è‰²ã‚’ç”»é¢è¡¨ç¤ºã¨åŒã˜ã« */
            .detail-card-wrapper {
                border: 1px solid #ddd !important;
                background-color: #fafafa !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                page-break-inside: avoid;
            }

            /* ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ */
            .notes-title {
                background-color: transparent !important;
                border-left: 4px solid var(--primary-color) !important;
            }

            /* 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®èƒŒæ™¯è‰²ã‚’ç”»é¢è¡¨ç¤ºã¨åŒã˜ã« */
            .notes-flex {
                background-color: transparent !important;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h2>ğŸ“„ å¸³ç¥¨ç”Ÿæˆãƒ„ãƒ¼ãƒ«</h2>

            <!-- Template Selection -->
            <div class="sidebar-section">
                <h3>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ</h3>
                <button class="template-btn" onclick="switchTemplate('invoice-individual')">
                    è«‹æ±‚æ›¸(å€‹äººå‘ã‘)
                </button>
                <button class="template-btn" onclick="switchTemplate('invoice-corporate')">
                    è«‹æ±‚æ›¸(ä¼æ¥­å‘ã‘)
                </button>
                <button class="template-btn active" onclick="switchTemplate('confirmation-individual')">
                    ä¾é ¼å†…å®¹ç¢ºèªæ›¸(å€‹äººå‘ã‘)
                </button>
                <button class="template-btn" onclick="switchTemplate('confirmation-corporate')">
                    ä¾é ¼å†…å®¹ç¢ºèªæ›¸(ä¼æ¥­å‘ã‘)
                </button>
            </div>

            <!-- Color Theme -->
            <div class="sidebar-section">
                <h3>ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ</h3>
                <button class="color-btn" onclick="changeColor('#00A3AF', '#72C7C3', '#F0FAFA')">
                    <span class="color-indicator" style="background: #00A3AF;"></span>
                    æµ…è‘±è‰²(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
                </button>
                <button class="color-btn" onclick="changeColor('#BE4B35', '#f5a89a', '#fcece9')">
                    <span class="color-indicator" style="background: #BE4B35;"></span>
                    ãƒ¬ãƒƒãƒ‰
                </button>
                <button class="color-btn" onclick="changeColor('#2E86AB', '#7fb3d5', '#e8f4f8')">
                    <span class="color-indicator" style="background: #2E86AB;"></span>
                    ãƒ–ãƒ«ãƒ¼
                </button>
                <button class="color-btn" onclick="changeColor('#2D6A4F', '#6fa88a', '#e8f5f0')">
                    <span class="color-indicator" style="background: #2D6A4F;"></span>
                    ã‚°ãƒªãƒ¼ãƒ³
                </button>
            </div>

            <!-- Download -->
            <div class="sidebar-section">
                <button class="download-btn" onclick="downloadPDF()">
                    ğŸ“¥ PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                </button>
            </div>
        </aside>

        <!-- Preview Area -->
        <main class="preview">
            <div class="a4-page" id="template-container">
                <!-- Templates will be loaded here -->
                <p style="text-align: center; color: #999; padding: 100px 0;">
                    ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­...
                </p>
            </div>
        </main>
    </div>

    <script>
        // Global State
        let currentTemplate = 'confirmation-individual';
        const templates = {};

        // Template Switching
        function switchTemplate(templateId) {
            currentTemplate = templateId;

            // Update button states
            document.querySelectorAll('.template-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Load template
            loadTemplate(templateId);
        }

        // Color Theme Change
        function changeColor(primary, accent, bg) {
            document.documentElement.style.setProperty('--primary-color', primary);
            document.documentElement.style.setProperty('--accent-color', accent);
            document.documentElement.style.setProperty('--bg-color', bg);
        }

        // PDF Download
        function downloadPDF() {
            const templateNames = {
                'invoice-individual': 'è«‹æ±‚æ›¸_å€‹äººæ§˜å‘ã‘',
                'invoice-corporate': 'è«‹æ±‚æ›¸_ä¼æ¥­æ§˜å‘ã‘',
                'confirmation-individual': 'ä¾é ¼å†…å®¹ç¢ºèªæ›¸_å€‹äººæ§˜å‘ã‘',
                'confirmation-corporate': 'ä¾é ¼å†…å®¹ç¢ºèªæ›¸_ä¼æ¥­æ§˜å‘ã‘'
            };

            const originalTitle = document.title;
            document.title = templateNames[currentTemplate] || 'å¸³ç¥¨';

            window.print();

            setTimeout(() => {
                document.title = originalTitle;
            }, 500);
        }

        // Template HTML Generators
        // 1. Confirmation Individual Template
        templates['confirmation-individual'] = function () {
            return `
                <div class="header">
                    <div class="header-left">
                        <div class="logo-placeholder">A</div>
                        <div class="title-area">
                            <h1>ä¾é ¼å†…å®¹ç¢ºèªæ›¸</h1>
                            <span>Request Confirmation</span>
                        </div>
                    </div>
                    <div class="doc-meta">
                        ç™ºè¡Œæ—¥: <span contenteditable="true">2026å¹´02æœˆ10æ—¥</span><br>
                        ç®¡ç†ç•ªå·: <span contenteditable="true">20260210-REQ</span>
                    </div>
                </div>

                <div class="address-area">
                    <div class="client-info">
                        <div class="client-name" contenteditable="true">å±±ç”°å¤ªéƒ æ§˜</div>
                        <div style="font-size: 12px; color: #666;">Email: <span contenteditable="true">sample@example.com</span></div>
                        <div style="font-size: 12px; color: #666; margin-top: 3px;">é€£çµ¡æ–¹æ³•: <span contenteditable="true">X(æ—§Twitter)DM - @AsagiMuu</span></div>
                        <div style="display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid var(--primary-color); padding-bottom: 5px; margin-top: 10px;">
                            <div style="font-weight: bold; font-size: 14px; color: var(--primary-color);">æ¦‚ç®—ãŠè¦‹ç©ã‚Š</div>
                            <div style="font-weight: bold; font-size: 24px; color: var(--text-color); line-height: 1; margin-right: 2px;">
                                Â¥ <span contenteditable="true">50,000</span> -
                            </div>
                        </div>
                    </div>
                    <div class="sender-info">
                        <div class="sender-job-title">ã‚¤ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼</div>
                        <div class="sender-name">Asagimuu (æµ…è‘± ã‚€ã†)</div>
                        <div>Web: https://asagimuu.com</div>
                        <div>Email: asagimuu1101@gmail.com</div>
                    </div>
                </div>

                <div class="table-wrap">
                    <table class="info-table">
                        <tr>
                            <th>ã”é¸æŠãƒ—ãƒ©ãƒ³</th>
                            <td contenteditable="true">ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³</td>
                            <th>åˆ©ç”¨åŒºåˆ†</th>
                            <td contenteditable="true">å€‹äººåˆ©ç”¨</td>
                        </tr>
                        <tr>
                            <th>ç´æœŸ</th>
                            <td contenteditable="true">2026å¹´03æœˆ31æ—¥</td>
                            <th>æ”¯æ‰•ã„æ–¹æ³•</th>
                            <td contenteditable="true">éŠ€è¡ŒæŒ¯è¾¼</td>
                        </tr>
                        <tr>
                            <th>å®Ÿç¸¾å…¬é–‹ã®å¯å¦</th>
                            <td contenteditable="true">è¨±å¯ / å…¬é–‹å¯èƒ½æ—¥: 2026å¹´04æœˆ01æ—¥</td>
                            <th>å…¬é–‹å ´æ‰€</th>
                            <td contenteditable="true">SNS, ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª, ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸</td>
                        </tr>
                    </table>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 2px; margin-bottom: 2px;">
                    <!-- ä½¿ç”¨ç”¨é€”æ¬„ -->
                    <div class="notes-area" style="flex: 1.5; min-height: 30px; margin: 0; padding: 6px 10px;">
                        <div class="notes-title" style="font-size: 12px; border-left-width: 3px; margin-bottom: 2px;">ä½¿ç”¨ç”¨é€”</div>
                        <p style="margin: 0; font-size: 13px;" contenteditable="true">SNSã‚¢ã‚¤ã‚³ãƒ³ã€å€‹äººã‚µã‚¤ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã¨ã—ã¦ä½¿ç”¨</p>
                    </div>

                    <!-- å‚è€ƒè³‡æ–™URLæ¬„ -->
                    <div class="notes-area" style="flex: 1; min-height: 30px; margin: 0; padding: 6px 10px;">
                        <div class="notes-title" style="font-size: 12px; border-left-width: 3px; margin-bottom: 2px;">å‚è€ƒè³‡æ–™URL</div>
                        <p style="margin: 0; font-size: 11px; word-break: break-all;" contenteditable="true">https://example.com/reference</p>
                    </div>
                </div>

                <!-- ã”ä¾é ¼è©³ç´°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="detail-section-header">
                    <div class="detail-section-title">ã”ä¾é ¼è©³ç´°</div>
                    <div class="detail-buttons">
                        <button class="add-detail-btn no-print" onclick="addDetailCard('individual')">+ è¿½åŠ </button>
                        <button class="delete-detail-btn no-print" onclick="deleteDetailCard('individual')">- å‰Šé™¤</button>
                    </div>
                </div>

                <div id="detail-container-individual">
                    <div class="detail-card-wrapper">
                        <div class="notes-area" style="margin: 0;">
                            <div class="notes-flex">
                                <!-- å·¦ã‚«ãƒ©ãƒ :ã‚¹ãƒšãƒƒã‚¯æƒ…å ± -->
                                <div class="notes-left">
                                    <div class="detail-card-number">1æšç›®</div>
                                    <span class="sub-label">â–  ã”ä¾é ¼ã®ç¨®é¡</span>
                                    <div class="sub-content" contenteditable="true">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¤ãƒ©ã‚¹ãƒˆ</div>

                                    <span class="sub-label">â–  ã‚µã‚¤ã‚ºãƒ»å½¢å¼</span>
                                    <div class="sub-content" contenteditable="true">
                                        ã‚«ãƒ©ãƒ¼:ãƒ•ãƒ«ã‚«ãƒ©ãƒ¼<br>
                                        ã‚µã‚¤ã‚º:A4<br>
                                        å½¢å¼:PNG, PSD
                                    </div>
                                    

                                </div>
                                
                                <!-- å³ã‚«ãƒ©ãƒ :è©³ç´°æœ¬æ–‡ -->
                                <div class="notes-right">
                                    <div style="display: flex;">
                                        <div style="flex: 1; border-right: 1px dashed #ddd; padding-right: 15px; margin-right: 15px;">
                                            <span class="sub-label">â–  ä¾é ¼å†…å®¹è©³ç´°</span>
                                            <div class="sub-content" style="white-space: pre-wrap;" contenteditable="true">ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ç³»ã®å¥³æ€§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
é«ªè‰²:éŠ€é«ªã€ç³:é’è‰²
æœè£…:é­”æ³•ä½¿ã„é¢¨ã®ãƒ­ãƒ¼ãƒ–</div>
                                        </div>
                                        <div style="width: 30%;">
                                            <span class="sub-label">â–  èƒŒæ™¯</span>
                                            <div class="sub-content" style="white-space: pre-wrap;" contenteditable="true">ã‚·ãƒ³ãƒ—ãƒ«ãªå˜è‰²èƒŒæ™¯</div>

                                            <span class="sub-label">â–  ã‚ªãƒ—ã‚·ãƒ§ãƒ³</span>
                                            <div class="sub-content" contenteditable="true">ãªã—</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ddd;">
                                <span class="sub-label">â–  ã‚¤ãƒ¡ãƒ¼ã‚¸ã«è¿‘ã„ã‚¤ãƒ©ã‚¹ãƒˆ</span>
                                <div class="sub-content" style="word-break: break-all; font-size: 10px; line-height: 1.4;" contenteditable="true">
                                    https://example.com/sample-image.jpg
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- å‚™è€ƒãƒ»è³ªå•æ¬„ -->
                <div class="notes-area" style="min-height: 30px; margin-top: 5px; margin-bottom: 5px; padding: 6px 10px;">
                    <div class="notes-title" style="font-size: 12px; border-left-width: 3px; margin-bottom: 2px;">å‚™è€ƒãƒ»è³ªå•</div>
                    <div style="margin: 0; font-size: 13px; white-space: pre-wrap;" contenteditable="true">ç‰¹ã«ãªã—</div>
                </div>

                <div style="margin-top: 5px; font-size: 10px; color: #888; border-top: 1px solid #eee; padding-top: 5px;">
                    <strong>ã€åˆ¶ä½œã«é–¢ã™ã‚‹æ³¨æ„äº‹é …ã€‘</strong><br>
                    ãƒ»æœ¬ç¢ºèªæ›¸ã®å†…å®¹ã«åŸºã¥ãåˆ¶ä½œã‚’é–‹å§‹ã„ãŸã—ã¾ã™ã€‚<br>
                    ãƒ»åˆ¶ä½œç€æ‰‹å¾Œã®å¤§å¹…ãªä»•æ§˜å¤‰æ›´ã¯ã€è¿½åŠ æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã”ã–ã„ã¾ã™ã€‚<br>
                    ãƒ»è‘—ä½œæ¨©ã®è­²æ¸¡ã«ã¤ã„ã¦ã¯ã€åˆ¥é€”å¥‘ç´„ãŒãªã„é™ã‚Šåˆ¶ä½œè€…ã«å¸°å±ã—ã¾ã™ã€‚
                </div>
            `;
        };



        // 2. Confirmation Corporate Template
        templates['confirmation-corporate'] = function () {
            return `
                <div class="header">
                    <div class="header-left">
                        <div class="logo-placeholder">A</div>
                        <div class="title-area">
                            <h1>ä¾é ¼å†…å®¹ç¢ºèªæ›¸</h1>
                            <span>Request Confirmation</span>
                        </div>
                    </div>
                    <div class="doc-meta">
                        ç™ºè¡Œæ—¥: <span contenteditable="true">2026å¹´02æœˆ10æ—¥</span><br>
                        ç®¡ç†ç•ªå·: <span contenteditable="true">20260210-REQ-CORP</span>
                    </div>
                </div>

                <div class="address-area">
                    <div class="client-info">
                        <div class="client-name" contenteditable="true">æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ« å¾¡ä¸­</div>
                        <div style="font-size: 12px; color: #666;">
                            æ‹…å½“è€…: <span contenteditable="true">å±±ç”°å¤ªéƒ æ§˜</span><br>
                            Email: <span contenteditable="true">sample@example.co.jp</span><br>
                            é€£çµ¡æ–¹æ³•: <span contenteditable="true">X(æ—§Twitter)DM - @AsagiMuu</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid var(--primary-color); padding-bottom: 5px; margin-top: 10px;">
                            <div style="font-weight: bold; font-size: 14px; color: var(--primary-color);">æ¦‚ç®—ãŠè¦‹ç©ã‚Š</div>
                            <div style="font-weight: bold; font-size: 24px; color: var(--text-color); line-height: 1; margin-right: 2px;">
                                Â¥ <span contenteditable="true">100,000</span> -
                            </div>
                        </div>
                    </div>
                    <div class="sender-info">
                        <div class="sender-job-title">ã‚¤ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼</div>
                        <div class="sender-name">Asagimuu (æµ…è‘± ã‚€ã†)</div>
                        <div>Web: https://asagimuu.com</div>
                        <div>Email: asagimuu1101@gmail.com</div>
                    </div>
                </div>

                <div class="table-wrap">
                    <table class="info-table">
                        <tr>
                            <th>ã”é¸æŠãƒ—ãƒ©ãƒ³</th>
                            <td contenteditable="true">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³</td>
                            <th>åˆ©ç”¨åŒºåˆ†</th>
                            <td contenteditable="true">å•†ç”¨åˆ©ç”¨</td>
                        </tr>
                        <tr>
                            <th>ç´æœŸ</th>
                            <td contenteditable="true">2026å¹´03æœˆ31æ—¥</td>
                            <th>æ”¯æ‰•ã„æ–¹æ³•</th>
                            <td contenteditable="true">éŠ€è¡ŒæŒ¯è¾¼</td>
                        </tr>
                        <tr>
                            <th>å®Ÿç¸¾å…¬é–‹ã®å¯å¦</th>
                            <td contenteditable="true">è¨±å¯ / å…¬é–‹å¯èƒ½æ—¥: 2026å¹´04æœˆ01æ—¥</td>
                            <th>å…¬é–‹å ´æ‰€</th>
                            <td contenteditable="true">SNS, ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª, ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸</td>
                        </tr>
                    </table>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 2px; margin-bottom: 2px;">
                    <!-- ä½¿ç”¨ç”¨é€”æ¬„ -->
                    <div class="notes-area" style="flex: 1.5; min-height: 30px; margin: 0; padding: 6px 10px;">
                        <div class="notes-title" style="font-size: 12px; border-left-width: 3px; margin-bottom: 2px;">ä½¿ç”¨ç”¨é€”</div>
                        <p style="margin: 0; font-size: 13px;" contenteditable="true">ä¼æ¥­ã‚µã‚¤ãƒˆã®ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã€åºƒå‘ŠãƒãƒŠãƒ¼ã¨ã—ã¦ä½¿ç”¨</p>
                    </div>

                    <!-- å‚è€ƒè³‡æ–™URLæ¬„ -->
                    <div class="notes-area" style="flex: 1; min-height: 30px; margin: 0; padding: 6px 10px;">
                        <div class="notes-title" style="font-size: 12px; border-left-width: 3px; margin-bottom: 2px;">å‚è€ƒè³‡æ–™URL</div>
                        <p style="margin: 0; font-size: 11px; word-break: break-all;" contenteditable="true">https://example.com/corporate-reference</p>
                    </div>
                </div>

                <!-- ã”ä¾é ¼è©³ç´°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="detail-section-header">
                    <div class="detail-section-title">ã”ä¾é ¼è©³ç´°</div>
                    <div class="detail-buttons">
                        <button class="add-detail-btn no-print" onclick="addDetailCard('corporate')">+ è¿½åŠ </button>
                        <button class="delete-detail-btn no-print" onclick="deleteDetailCard('corporate')">- å‰Šé™¤</button>
                    </div>
                </div>

                <div id="detail-container-corporate">
                    <div class="detail-card-wrapper">
                        <div class="notes-area" style="margin: 0;">
                            <div class="notes-flex">
                                <!-- å·¦ã‚«ãƒ©ãƒ :ã‚¹ãƒšãƒƒã‚¯æƒ…å ± -->
                                <div class="notes-left">
                                    <div class="detail-card-number">1æšç›®</div>
                                    <span class="sub-label">â–  ã”ä¾é ¼ã®ç¨®é¡</span>
                                    <div class="sub-content" contenteditable="true">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¤ãƒ©ã‚¹ãƒˆ</div>

                                    <span class="sub-label">â–  ã‚µã‚¤ã‚ºãƒ»å½¢å¼</span>
                                    <div class="sub-content" contenteditable="true">
                                        ã‚«ãƒ©ãƒ¼:ãƒ•ãƒ«ã‚«ãƒ©ãƒ¼<br>
                                        ã‚µã‚¤ã‚º:A3<br>
                                        å½¢å¼:PNG, AI, PSD
                                    </div>
                                    

                                </div>
                                
                                <!-- å³ã‚«ãƒ©ãƒ :è©³ç´°æœ¬æ–‡ -->
                                <div class="notes-right">
                                    <div style="display: flex;">
                                        <div style="flex: 1; border-right: 1px dashed #ddd; padding-right: 15px; margin-right: 15px;">
                                            <span class="sub-label">â–  ä¾é ¼å†…å®¹è©³ç´°</span>
                                            <div class="sub-content" style="white-space: pre-wrap;" contenteditable="true">ä¼æ¥­ãƒã‚¹ã‚³ãƒƒãƒˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
æ˜ã‚‹ãè¦ªã—ã¿ã‚„ã™ã„é›°å›²æ°—
æœè£…:ãƒ“ã‚¸ãƒã‚¹ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«</div>
                                        </div>
                                        <div style="width: 30%;">
                                            <span class="sub-label">â–  èƒŒæ™¯</span>
                                            <div class="sub-content" style="white-space: pre-wrap;" contenteditable="true">ä¼æ¥­ã‚«ãƒ©ãƒ¼ã‚’ä½¿ç”¨ã—ãŸèƒŒæ™¯</div>

                                            <span class="sub-label">â–  ã‚ªãƒ—ã‚·ãƒ§ãƒ³</span>
                                            <div class="sub-content" contenteditable="true">ãªã—</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ddd;">
                                <span class="sub-label">â–  ã‚¤ãƒ¡ãƒ¼ã‚¸ã«è¿‘ã„ã‚¤ãƒ©ã‚¹ãƒˆ</span>
                                <div class="sub-content" style="word-break: break-all; font-size: 10px; line-height: 1.4;" contenteditable="true">
                                    https://example.com/corporate-sample.jpg
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å‚™è€ƒãƒ»è³ªå•æ¬„ -->
                <div class="notes-area" style="min-height: 30px; margin-top: 5px; margin-bottom: 5px; padding: 6px 10px;">
                    <div class="notes-title" style="font-size: 12px; border-left-width: 3px; margin-bottom: 2px;">å‚™è€ƒãƒ»è³ªå•</div>
                    <div style="margin: 0; font-size: 13px; white-space: pre-wrap;" contenteditable="true">ç‰¹ã«ãªã—</div>
                </div>

                <div style="margin-top: 5px; font-size: 10px; color: #888; border-top: 1px solid #eee; padding-top: 5px;">
                    <strong>ã€åˆ¶ä½œã«é–¢ã™ã‚‹æ³¨æ„äº‹é …ã€‘</strong><br>
                    ãƒ»æœ¬ç¢ºèªæ›¸ã®å†…å®¹ã«åŸºã¥ãåˆ¶ä½œã‚’é–‹å§‹ã„ãŸã—ã¾ã™ã€‚<br>
                    ãƒ»åˆ¶ä½œç€æ‰‹å¾Œã®å¤§å¹…ãªä»•æ§˜å¤‰æ›´ã¯ã€è¿½åŠ æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã”ã–ã„ã¾ã™ã€‚<br>
                    ãƒ»è‘—ä½œæ¨©ã®è­²æ¸¡ã«ã¤ã„ã¦ã¯ã€åˆ¥é€”å¥‘ç´„ãŒãªã„é™ã‚Šåˆ¶ä½œè€…ã«å¸°å±ã—ã¾ã™ã€‚
                </div>
            `;
        };



        // 3. Invoice Individual Template
        templates['invoice-individual'] = function () {
            return `
                <div class="header">
                    <div class="header-left">
                        <div class="logo-placeholder">A</div>
                        <div class="title-area">
                            <h1>è«‹æ±‚æ›¸</h1>
                            <span>INVOICE</span>
                        </div>
                    </div>
                    <div class="doc-meta">
                        è«‹æ±‚æ—¥: <span contenteditable="true">2026å¹´02æœˆ10æ—¥</span><br>
                        è«‹æ±‚ç•ªå·: <span contenteditable="true">INV-20260210-001</span><br>
                        æ”¯æ‰•æœŸé™: <span contenteditable="true">2026å¹´02æœˆ28æ—¥</span>
                    </div>
                </div>

                <div class="address-area">
                    <div class="client-info">
                        <div class="client-name" contenteditable="true">å±±ç”°å¤ªéƒ æ§˜</div>
                        <div style="font-size: 13px; margin-top: 8px;">ä¸‹è¨˜ã®é€šã‚Šã”è«‹æ±‚ç”³ã—ä¸Šã’ã¾ã™ã€‚</div>
                        <div style="font-size: 12px; color: #666; margin-top: 3px;">é€£çµ¡æ–¹æ³•: <span contenteditable="true">X(æ—§Twitter)DM - @AsagiMuu</span></div>
                    </div>
                    <div class="sender-info">
                        <div class="sender-job-title">ã‚¤ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼</div>
                        <div class="sender-name">Asagimuu (æµ…è‘± ã‚€ã†)</div>
                        <div>Web: https://asagimuu.com</div>
                        <div>Email: asagimuu1101@gmail.com</div>
                    </div>
                </div>

                <div class="total-area">
                    <span class="total-label">ã”è«‹æ±‚é‡‘é¡ (ç¨è¾¼)</span>
                    <span class="total-amount">Â¥ <span contenteditable="true">55,000</span> -</span>
                </div>

                <div class="table-wrap" style="margin-top: 25px;">
                    <table style="text-align: left;">
                        <thead style="background-color: var(--bg-color);">
                            <tr>
                                <th style="width: 50%; border-right: none;">å“åãƒ»è©³ç´°</th>
                                <th style="width: 10%; text-align: center; border-right: none;">æ•°é‡</th>
                                <th style="width: 20%; text-align: right; border-right: none;">å˜ä¾¡</th>
                                <th style="width: 20%; text-align: right;">é‡‘é¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border-left: none;" contenteditable="true">ã‚¤ãƒ©ã‚¹ãƒˆåˆ¶ä½œè²» (ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³)</td>
                                <td style="text-align: center;" contenteditable="true">1</td>
                                <td style="text-align: right;" contenteditable="true">50,000</td>
                                <td style="text-align: right;" contenteditable="true">50,000</td>
                                <td class="invoice-row-controls no-print">
                                    <button class="add-row-btn" onclick="addInvoiceRow(this)" title="è¡Œã‚’è¿½åŠ ">+</button>
                                    <button class="delete-row-btn" onclick="deleteInvoiceRow(this)" title="è¡Œã‚’å‰Šé™¤">-</button>
                                </td>
                            </tr>
                            <tr>
                                <td style="border-left: none;" contenteditable="true">ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ»ä¿®æ­£è²»ãªã©</td>
                                <td style="text-align: center;" contenteditable="true">1</td>
                                <td style="text-align: right;" contenteditable="true">0</td>
                                <td style="text-align: right;" contenteditable="true">0</td>
                                <td class="invoice-row-controls no-print">
                                    <button class="add-row-btn" onclick="addInvoiceRow(this)" title="è¡Œã‚’è¿½åŠ ">+</button>
                                    <button class="delete-row-btn" onclick="deleteInvoiceRow(this)" title="è¡Œã‚’å‰Šé™¤">-</button>
                                </td>
                            </tr>
                            <tr style="border-top: 2px solid var(--primary-color);">
                                <td colspan="2" style="border: none;"></td>
                                <td style="background-color: var(--bg-color); text-align: right; font-weight: bold; border: none;">å°è¨ˆ</td>
                                <td style="background-color: var(--bg-color); text-align: right; border: none;" contenteditable="true">50,000</td>
                            </tr>
                            <tr>
                                <td colspan="2" style="border: none;"></td>
                                <td style="background-color: var(--bg-color); text-align: right; border: none;">æ¶ˆè²»ç¨ (10%)</td>
                                <td style="background-color: var(--bg-color); text-align: right; border: none;" contenteditable="true">5,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="bank-info">
                    <div class="bank-title">ã€ãŠæŒ¯è¾¼å…ˆã€‘</div>
                    <div style="margin-top: 5px; font-weight: 500;" contenteditable="true">
                        æ¥½å¤©éŠ€è¡Œã€€ã€‡ã€‡æ”¯åº— (æ”¯åº—ç•ªå·: xxx)<br>
                        æ™®é€šã€€1234567ã€€å£åº§åç¾©ï¼š ã‚¢ã‚µã‚®ãƒ ã‚¦
                    </div>
                    <div style="margin-top: 10px; font-size: 11px; color: #888;">
                        â€»æã‚Œå…¥ã‚Šã¾ã™ãŒã€æŒ¯è¾¼æ‰‹æ•°æ–™ã¯è²´ç¤¾ã«ã¦ã”è² æ‹…é¡˜ã„ã¾ã™ã€‚
                    </div>
                </div>

                <div class="notes-area" style="margin-top: 10px; min-height: 40px;">
                    <div class="notes-title">å‚™è€ƒ</div>
                    <div contenteditable="true">ã“ã¡ã‚‰ã«å‚™è€ƒã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚</div>
                </div>
            `;
        };

        // 4. Invoice Corporate Template
        templates['invoice-corporate'] = function () {
            return `
                <div class="header">
                    <div class="header-left">
                        <div class="logo-placeholder">A</div>
                        <div class="title-area">
                            <h1>è«‹æ±‚æ›¸</h1>
                            <span>INVOICE</span>
                        </div>
                    </div>
                    <div class="doc-meta">
                        è«‹æ±‚æ—¥: <span contenteditable="true">2026å¹´02æœˆ10æ—¥</span><br>
                        è«‹æ±‚ç•ªå·: <span contenteditable="true">INV-20260210-CORP-001</span><br>
                        æ”¯æ‰•æœŸé™: <span contenteditable="true">2026å¹´02æœˆ28æ—¥</span>
                    </div>
                </div>

                <div class="address-area">
                    <div class="client-info">
                        <div class="client-name" contenteditable="true">æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ« å¾¡ä¸­</div>
                        <div style="font-size: 13px; margin-top: 8px;">
                            æ‹…å½“è€…: <span contenteditable="true">å±±ç”°å¤ªéƒ æ§˜</span><br>
                            ä¸‹è¨˜ã®é€šã‚Šã”è«‹æ±‚ç”³ã—ä¸Šã’ã¾ã™ã€‚<br>
                            <span style="font-size: 12px; color: #666;">é€£çµ¡æ–¹æ³•: <span contenteditable="true">X(æ—§Twitter)DM - @AsagiMuu</span></span>
                        </div>
                    </div>
                    <div class="sender-info">
                        <div class="sender-job-title">ã‚¤ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼</div>
                        <div class="sender-name">Asagimuu (æµ…è‘± ã‚€ã†)</div>
                        <div>Web: https://asagimuu.com</div>
                        <div>Email: asagimuu1101@gmail.com</div>
                    </div>
                </div>

                <div class="total-area">
                    <span class="total-label">ã”è«‹æ±‚é‡‘é¡ (ç¨è¾¼)</span>
                    <span class="total-amount">Â¥ <span contenteditable="true">110,000</span> -</span>
                </div>

                <div class="table-wrap" style="margin-top: 25px;">
                    <table style="text-align: left;">
                        <thead style="background-color: var(--bg-color);">
                            <tr>
                                <th style="width: 50%; border-right: none;">å“åãƒ»è©³ç´°</th>
                                <th style="width: 10%; text-align: center; border-right: none;">æ•°é‡</th>
                                <th style="width: 20%; text-align: right; border-right: none;">å˜ä¾¡</th>
                                <th style="width: 20%; text-align: right;">é‡‘é¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border-left: none;" contenteditable="true">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¤ãƒ©ã‚¹ãƒˆåˆ¶ä½œ (å•†ç”¨)</td>
                                <td style="text-align: center;" contenteditable="true">1</td>
                                <td style="text-align: right;" contenteditable="true">100,000</td>
                                <td style="text-align: right;" contenteditable="true">100,000</td>
                                <td class="invoice-row-controls no-print">
                                    <button class="add-row-btn" onclick="addInvoiceRow(this)" title="è¡Œã‚’è¿½åŠ ">+</button>
                                    <button class="delete-row-btn" onclick="deleteInvoiceRow(this)" title="è¡Œã‚’å‰Šé™¤">-</button>
                                </td>
                            </tr>
                            <tr>
                                <td style="border-left: none;" contenteditable="true">ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ»ä¿®æ­£è²»ãªã©</td>
                                <td style="text-align: center;" contenteditable="true">1</td>
                                <td style="text-align: right;" contenteditable="true">0</td>
                                <td style="text-align: right;" contenteditable="true">0</td>
                                <td class="invoice-row-controls no-print">
                                    <button class="add-row-btn" onclick="addInvoiceRow(this)" title="è¡Œã‚’è¿½åŠ ">+</button>
                                    <button class="delete-row-btn" onclick="deleteInvoiceRow(this)" title="è¡Œã‚’å‰Šé™¤">-</button>
                                </td>
                            </tr>
                            <tr style="border-top: 2px solid var(--primary-color);">
                                <td colspan="2" style="border: none;"></td>
                                <td style="background-color: var(--bg-color); text-align: right; font-weight: bold; border: none;">å°è¨ˆ</td>
                                <td style="background-color: var(--bg-color); text-align: right; border: none;" contenteditable="true">100,000</td>
                            </tr>
                            <tr>
                                <td colspan="2" style="border: none;"></td>
                                <td style="background-color: var(--bg-color); text-align: right; border: none;">æ¶ˆè²»ç¨ (10%)</td>
                                <td style="background-color: var(--bg-color); text-align: right; border: none;" contenteditable="true">10,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="bank-info">
                    <div class="bank-title">ã€ãŠæŒ¯è¾¼å…ˆã€‘</div>
                    <div style="margin-top: 5px; font-weight: 500;" contenteditable="true">
                        æ¥½å¤©éŠ€è¡Œã€€ã€‡ã€‡æ”¯åº— (æ”¯åº—ç•ªå·: xxx)<br>
                        æ™®é€šã€€1234567ã€€å£åº§åç¾©ï¼š ã‚¢ã‚µã‚®ãƒ ã‚¦
                    </div>
                    <div style="margin-top: 10px; font-size: 11px; color: #888;">
                        â€»æã‚Œå…¥ã‚Šã¾ã™ãŒã€æŒ¯è¾¼æ‰‹æ•°æ–™ã¯è²´ç¤¾ã«ã¦ã”è² æ‹…é¡˜ã„ã¾ã™ã€‚
                    </div>
                </div>

                <div class="notes-area" style="margin-top: 10px; min-height: 40px;">
                    <div class="notes-title">å‚™è€ƒ</div>
                    <div contenteditable="true">ã“ã¡ã‚‰ã«å‚™è€ƒã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚</div>
                </div>
            `;
        };

        // Card Management Functions
        function addCard(containerId) {
            const container = document.getElementById(containerId);
            const cards = container.querySelectorAll('.detail-card');
            const newNumber = cards.length + 1;

            const newCard = cards[0].cloneNode(true);
            newCard.querySelector('.card-number').textContent = newNumber + 'æšç›®';

            container.appendChild(newCard);
        }

        function removeCard(button) {
            const card = button.closest('.detail-card');
            const container = card.parentElement;

            if (container.children.length <= 1) {
                alert('æœ€ä½1ã¤ã®ä¾é ¼è©³ç´°ãŒå¿…è¦ã§ã™ã€‚');
                return;
            }

            card.remove();

            // Renumber remaining cards
            const cards = container.querySelectorAll('.detail-card');
            cards.forEach((c, index) => {
                c.querySelector('.card-number').textContent = (index + 1) + 'æšç›®';
            });
        }

        // Detail Card Management Functions (for Confirmation Templates)
        function addDetailCard(type) {
            const containerId = `detail-container-${type}`;
            const container = document.getElementById(containerId);
            const cards = container.querySelectorAll('.detail-card-wrapper');
            const newNumber = cards.length + 1;

            const newCard = cards[0].cloneNode(true);
            newCard.querySelector('.detail-card-number').textContent = newNumber + 'æšç›®';

            // å…¥åŠ›å†…å®¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆä»»æ„ï¼‰
            // newCard.querySelectorAll('[contenteditable]').forEach(el => el.textContent = '');

            container.appendChild(newCard);
        }

        function deleteDetailCard(type) {
            const containerId = `detail-container-${type}`;
            const container = document.getElementById(containerId);
            const cards = container.querySelectorAll('.detail-card-wrapper');

            if (cards.length <= 1) {
                alert('æœ€ä½1ã¤ã®ä¾é ¼è©³ç´°ãŒå¿…è¦ã§ã™ã€‚');
                return;
            }

            // Remove last card
            cards[cards.length - 1].remove();

            // ç•ªå·ã®æŒ¯ã‚Šç›´ã—ã¯å¿…è¦ãªã„ï¼ˆæœ«å°¾ã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ï¼‰ã§ã™ãŒã€å¿µã®ãŸã‚è¡Œã†å ´åˆã¯ä»¥ä¸‹
            /*
            const remainingCards = container.querySelectorAll('.detail-card-wrapper');
            remainingCards.forEach((card, index) => {
                card.querySelector('.detail-card-number').textContent = (index + 1) + 'æšç›®';
            });
            */
        }

        // Invoice Row Management Functions
        function addInvoiceRow(button) {
            const row = button.closest('tr');
            const tbody = row.parentElement;
            const newRow = row.cloneNode(true);

            // Clear contenteditable fields
            newRow.querySelectorAll('[contenteditable="true"]').forEach(field => {
                if (field.tagName === 'TD') {
                    field.textContent = '0';
                }
            });

            tbody.insertBefore(newRow, row.nextSibling);
        }

        function deleteInvoiceRow(button) {
            const row = button.closest('tr');
            const tbody = row.parentElement;
            const dataRows = tbody.querySelectorAll('tr:not([style*="border-top"])');

            if (dataRows.length <= 1) {
                alert('æœ€ä½1ã¤ã®å“ç›®ãŒå¿…è¦ã§ã™ã€‚');
                return;
            }

            row.remove();
        }

        function loadTemplate(templateId) {
            const container = document.getElementById('template-container');

            if (templates[templateId]) {
                container.innerHTML = templates[templateId]();
            } else {
                container.innerHTML = `<p style="text-align: center; color: #999; padding: 100px 0;">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ "${templateId}" ã¯æº–å‚™ä¸­ã§ã™...</p>`;
            }
        }

        // Initialize
        function init() {
            loadTemplate(currentTemplate);
        }

        // Run on page load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>