<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>よくある質問 - AsagiMuu Portfolio</title>
    <link rel="icon" href="./images/ui/2025-09-02_01_AsagiMuu-01.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <!-- OGP Settings -->
    <meta property="og:title" content="よくある質問 - AsagiMuu Portfolio">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://your-site-url.com/faq.html">
    <meta property="og:image" content="https://your-site-url.com/images/ui/2025-09-02_01_AsagiMuu.png">
    <meta property="og:description" content="ご依頼に関するよくある質問をまとめました。">
    <meta property="og:site_name" content="AsagiMuu Portfolio">
    <meta name="twitter:card" content="summary_large_image">
    <script src="site-data.js"></script>
    <script src="common.js" defer></script>
    <script src="components.js"></script>
</head>

<body>

    <!-- Navigation and Mobile Menu will be injected by components.js -->
    <nav id="main-nav" class="fixed w-full z-50 bg-white/80 backdrop-blur-md border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-6 py-3 flex justify-between items-center">
            <a href="index.html" id="logo-link" class="flex items-center">
                <img id="logo-image" src="./images/ui/2024-09-05_01_AsagiMuu_02.png" alt="AsagiMuu" class="h-[34px]">
            </a>

            <div id="desktop-nav"
                class="hidden md:flex space-x-8 text-[11px] tracking-[0.2em] uppercase font-bold text-gray-400">
                <a href="index.html" class="nav-link hover:text-gray-800 transition">トップ</a>
                <div class="relative group">
                    <a href="gallery.html" class="nav-link hover:text-gray-800 transition block">アート</a>
                    <div
                        class="absolute left-1/2 transform -translate-x-1/2 top-full pt-4 w-32 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                        <div class="bg-white border border-gray-100 shadow-lg rounded-lg overflow-hidden">
                            <a href="gallery.html?from=gallery"
                                class="block px-4 py-3 text-center text-gray-500 hover:text-[#BE4B35] hover:bg-gray-50 text-[10px] tracking-widest whitespace-nowrap">すべて見る</a>
                        </div>
                    </div>
                </div>
                <a href="about.html" class="nav-link hover:text-gray-800 transition">プロフィール</a>
                <div class="relative group">
                    <a href="pricing.html" class="nav-link hover:text-gray-800 transition block">依頼について</a>
                    <div
                        class="absolute left-1/2 transform -translate-x-1/2 top-full pt-4 w-40 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                        <div class="bg-white border border-gray-100 shadow-lg rounded-lg overflow-hidden">
                            <a href="pricing.html"
                                class="block px-4 py-3 text-center text-gray-500 hover:text-[#BE4B35] hover:bg-gray-50 text-[10px] tracking-widest whitespace-nowrap">個人様向け料金プラン</a>
                            <a href="pricing-corporate.html"
                                class="block px-4 py-3 text-center text-gray-500 hover:text-[#BE4B35] hover:bg-gray-50 text-[10px] tracking-widest whitespace-nowrap border-t border-gray-50">企業様向け依頼プラン</a>
                            <a href="terms.html?mode=view"
                                class="block px-4 py-3 text-center text-gray-500 hover:text-[#BE4B35] hover:bg-gray-50 text-[10px] tracking-widest whitespace-nowrap border-t border-gray-50">利用規約</a>
                            <a href="faq.html"
                                class="block px-4 py-3 text-center text-gray-500 hover:text-[#BE4B35] hover:bg-gray-50 text-[10px] tracking-widest whitespace-nowrap border-t border-gray-50">よくある質問</a>
                        </div>
                    </div>
                </div>
                <a href="links.html" class="nav-link hover:text-gray-800 transition">リンク</a>
                <a href="contact.html" class="nav-link hover:text-gray-800 transition">お問い合わせ</a>
            </div>

            <button id="menu-btn" class="md:hidden text-2xl text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu"
        class="fixed inset-0 bg-white z-40 transform translate-x-full md:hidden flex flex-col items-center justify-center space-y-8 text-xl tracking-widest uppercase">
        <a href="index.html">トップ</a>
        <a href="gallery.html">アート</a>
        <a href="about.html">プロフィール</a>
        <a href="pricing.html">依頼について</a>
        <a href="links.html">リンク</a>
        <a href="contact.html">お問い合わせ</a>
        <button id="close-menu" class="absolute top-6 right-6 text-3xl">&times;</button>
    </div>

    <!-- FAQ VIEW -->
    <main id="view-faq"
        class="page-view active pt-32 pb-24 px-6 max-w-4xl mx-auto min-h-screen opacity-0 transition-opacity duration-500">
        <div class="mb-8">
            <a id="back-to-flow-link" href="workflow.html"
                class="group inline-flex items-center px-5 py-2 bg-gray-800 text-white rounded-full text-sm font-bold tracking-widest transition-all duration-300 hover:bg-[#BE4B35] hover:shadow-lg hover:-translate-y-1 shadow-md">
                <i class="fa-solid fa-arrow-left mr-2 transition-transform duration-300 group-hover:-translate-x-1"></i>
                <span>トップページに戻る</span>
            </a>
        </div>

        <div class="text-center mb-12">
            <h2 class="text-3xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl">
                よくある質問
            </h2>
            <p class="mt-4 max-w-2xl text-lg text-gray-500 mx-auto">
                ご依頼に関してよくいただく質問をまとめました。
            </p>
        </div>

        <div id="faq-container" class="space-y-4">
            <!-- FAQ items will be injected here -->
        </div>
    </main>

    <!-- Footer will be injected by components.js --> class="py-16 text-center text-gray-300 text-[9px] tracking-[0.4em]
    uppercase border-t border-gray-50 bg-white">
    &copy; 2025 ASAGIMUU Portfolio
    </footer>

    <!-- Image Modal -->
    <div id="image-modal"
        class="fixed inset-0 bg-black/80 z-[100] hidden flex items-center justify-center backdrop-blur-sm opacity-0 transition-opacity duration-300">
        <div class="relative max-w-5xl max-h-[90vh] p-4">
            <button id="close-modal-btn"
                class="absolute -top-12 right-0 text-white text-4xl hover:text-[#BE4B35] transition">&times;</button>
            <img id="modal-img" src="" alt="Expanded Image"
                class="max-w-full max-h-[85vh] rounded-lg shadow-2xl object-contain">
        </div>
        <button id="close-modal-bg" class="absolute inset-0 w-full h-full cursor-default -z-10"></button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let siteConfig = {};

            function renderFaqs(faqData) {
                const container = document.getElementById('faq-container');
                if (!container || !faqData || !faqData.faqs) return;

                container.innerHTML = faqData.faqs.map((faq, index) => {
                    let mediaHtml = '';
                    const images = faq.images || (faq.image ? [faq.image] : []);

                    if (images.length > 0) {
                        const imageElements = images.map(item => {
                            const src = typeof item === 'string' ? item : item.src;
                            const caption = (typeof item === 'object' && item.caption) ? item.caption : '';

                            return `
                        <div class="relative h-64 sm:h-72 bg-gray-50 rounded-lg overflow-hidden border border-gray-200 flex-shrink-0 cursor-pointer hover:opacity-90 transition group" onclick="openImageModal('${src}')">
                            <img src="${src}" alt="参考画像" class="h-full w-auto">
                            ${caption ? `<div class="absolute bottom-0 left-0 bg-black/60 text-white text-[10px] px-2 py-1 font-bold backdrop-blur-sm rounded-tr-lg">${caption}</div>` : ''}
                        </div>
                    `}).join('');

                        mediaHtml = `
                        <div class="flex overflow-x-auto gap-3 mt-4 pb-2 custom-scrollbar">
                            ${imageElements}
                        </div>
                    `;
                    }

                    return `
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                    <button class="faq-question w-full text-left p-6 flex justify-between items-center hover:bg-gray-50 transition">
                        <span class="font-bold text-gray-800">${faq.question}</span>
                        <i class="fa-solid fa-chevron-down text-gray-400 transition-transform"></i>
                    </button>
                    <div class="faq-answer hidden p-6 pt-0 text-gray-600 text-sm leading-relaxed">
                        <p class="whitespace-pre-wrap">${faq.answer}</p>
                        ${mediaHtml}
                    </div>
                </div>
            `}).join('');

                container.querySelectorAll('.faq-question').forEach(button => {
                    button.addEventListener('click', () => {
                        const answer = button.nextElementSibling;
                        const icon = button.querySelector('i');

                        if (answer.classList.contains('hidden')) {
                            answer.classList.remove('hidden');
                            icon.classList.add('rotate-180');
                        } else {
                            answer.classList.add('hidden');
                            icon.classList.remove('rotate-180');
                        }
                    });
                });
            }

            // Modal Logic
            const imageModal = document.getElementById('image-modal');
            const modalImg = document.getElementById('modal-img');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const closeModalBg = document.getElementById('close-modal-bg');

            window.openImageModal = (src) => {
                modalImg.src = src;
                imageModal.classList.remove('hidden');
                requestAnimationFrame(() => {
                    imageModal.classList.remove('opacity-0');
                });
            };

            const closeModal = () => {
                imageModal.classList.add('opacity-0');
                setTimeout(() => {
                    imageModal.classList.add('hidden');
                    modalImg.src = '';
                }, 300);
            };

            if (closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
            if (closeModalBg) closeModalBg.addEventListener('click', closeModal);

            async function initializeSite() {
                try {
                    siteConfig = await loadCommonData();

                    // --- Navigation Highlighting ---
                    const navLinks = document.querySelectorAll('#desktop-nav a.nav-link');
                    navLinks.forEach(link => {
                        link.classList.remove('active-nav-item');
                        link.classList.add('hover:text-gray-800');
                    });
                    const currentPath = window.location.pathname.split("/").pop();
                    let activeLink = null;
                    if (currentPath === 'index.html' || currentPath === '') {
                        activeLink = document.querySelector('a.nav-link[href^="index.html"]');
                    } else if (['pricing.html', 'pricing-corporate.html', 'terms.html', 'faq.html', 'workflow.html', 'form.html'].includes(currentPath)) {
                        activeLink = document.querySelector('a.nav-link[href="pricing.html"]');
                    } else {
                        activeLink = document.querySelector(`#desktop-nav a.nav-link[href="${currentPath}"]`);
                    }
                    if (activeLink) {
                        const mainLink = activeLink.closest('.relative.group')?.querySelector('a.nav-link') || activeLink;
                        mainLink.classList.add('active-nav-item');
                        mainLink.classList.remove('hover:text-gray-800');
                    }
                    // --- End Navigation Highlighting ---

                    // ドロップダウン内の「よくある質問」をアクティブにする
                    const faqDropdownLink = document.querySelector('a[href*="faq.html"]');
                    if (faqDropdownLink) {
                        faqDropdownLink.classList.remove('text-gray-500');
                        faqDropdownLink.classList.add('text-[#BE4B35]', 'bg-gray-50');
                    }

                    // Load FAQ data
                    const faqData = (typeof SITE_DATA !== 'undefined' && SITE_DATA.faq) ? { faqs: SITE_DATA.faq } : { faqs: [] };

                    renderFaqs(faqData);

                    // URLパラメータ(q)に基づいて該当する質問を開く
                    const urlParams = new URLSearchParams(window.location.search);
                    const query = urlParams.get('q');

                    if (query) {
                        setTimeout(() => {
                            const buttons = document.querySelectorAll('.faq-question');
                            let targetBtn = null;

                            for (const btn of buttons) {
                                // 'background' というキーワードは特別に「簡単な背景」の質問に紐づける（互換性のため）
                                // それ以外は、質問文にキーワードが含まれているか検索する
                                if ((query === 'background' && btn.textContent.includes('「簡単な背景」と「難しい背景」の違い')) ||
                                    (query !== 'background' && btn.textContent.includes(query))) {
                                    targetBtn = btn;
                                    break;
                                }
                            }

                            if (targetBtn) {
                                const answer = targetBtn.nextElementSibling;
                                if (answer.classList.contains('hidden')) {
                                    targetBtn.click(); // 閉じていれば開く
                                }
                                targetBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });

                                // 強調表示
                                const container = targetBtn.parentElement;
                                container.classList.add('ring-2', 'ring-[#BE4B35]', 'ring-offset-2');
                                setTimeout(() => container.classList.remove('ring-2', 'ring-[#BE4B35]', 'ring-offset-2'), 2000);
                            }
                        }, 100);
                    }

                    // Set back link based on referrer if possible
                    const backLink = document.getElementById('back-to-flow-link');
                    const backLinkText = backLink.querySelector('span');

                    if (document.referrer && document.referrer.includes('workflow.html')) {
                        backLink.href = "#";
                        if (backLinkText) backLinkText.textContent = "依頼の流れに戻る";
                        backLink.addEventListener('click', (e) => {
                            e.preventDefault();
                            history.back();
                        });
                    } else if (document.referrer && document.referrer.includes('terms.html')) {
                        backLink.href = "#";
                        if (backLinkText) backLinkText.textContent = "利用規約に戻る";
                        backLink.addEventListener('click', (e) => {
                            e.preventDefault();
                            history.back();
                        });
                    } else if (document.referrer && document.referrer.includes('pricing.html')) {
                        backLink.href = 'pricing.html';
                        if (backLinkText) backLinkText.textContent = "料金プランに戻る";
                    } else {
                        backLink.href = 'index.html';
                        if (backLinkText) backLinkText.textContent = "トップページに戻る";
                    }

                } catch (error) {
                    console.error("データの読み込みに失敗しました:", error);
                } finally {
                    document.getElementById('view-faq').classList.remove('opacity-0');
                }
            }
            initializeSite();
        });
    </script>
</body>

</html>